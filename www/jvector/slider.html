<!DOCTYPE html>
<html>

<head>
    <meta name="generator" content="HTML Tidy for HTML5 (experimental) for Windows https://github.com/w3c/tidy-html5/tree/c63cc39">
    <title>
        jVectorMap demo
    </title>
    <link rel="stylesheet" media="all" href="jquery-jvectormap.css">
    <link rel="stylesheet" media="all" href="themes/base/jquery.ui.all.css">
    <script src="assets/jquery-latest.js">
    </script>
    <!-- // <script src="assets/jquery-1.8.2.js"></script> -->

    <script src="jquery-jvectormap.js">
    </script>
    <script src="jquery-mousewheel.js">
    </script>
    <script src="lib/jvectormap.js">
    </script>
    <script src="lib/abstract-element.js">
    </script>
    <script src="lib/abstract-canvas-element.js">
    </script>
    <script src="lib/abstract-shape-element.js">
    </script>
    <script src="lib/svg-element.js">
    </script>
    <script src="lib/svg-group-element.js">
    </script>
    <script src="lib/svg-canvas-element.js">
    </script>
    <script src="lib/svg-shape-element.js">
    </script>
    <script src="lib/svg-path-element.js">
    </script>
    <script src="lib/svg-circle-element.js">
    </script>
    <script src="lib/vml-element.js">
    </script>
    <script src="lib/vml-group-element.js">
    </script>
    <script src="lib/vml-canvas-element.js">
    </script>
    <script src="lib/vml-shape-element.js">
    </script>
    <script src="lib/vml-path-element.js">
    </script>
    <script src="lib/vml-circle-element.js">
    </script>
    <script src="lib/vector-canvas.js">
    </script>
    <script src="lib/simple-scale.js">
    </script>
    <script src="lib/numeric-scale.js">
    </script>
    <script src="lib/ordinal-scale.js">
    </script>
    <script src="lib/color-scale.js">
    </script>
    <script src="lib/data-series.js">
    </script>
    <script src="lib/proj.js">
    </script>
    <script src="lib/world-map.js">
    </script>
    <!-- // <script src="assets/jquery-jvectormap-world-mill-en.js"></script> -->
    <!-- Load map and data -->

    <script src="assets/jquery.vmap.africa_west.js">
    </script>
    <script src="assets/jquery.vmap.africa_south.js">
    </script>
    <script src="assets/jquery.vmap.africa_east.js">
    </script>
    <script src="assets/jquery.vmap.africa_north.js">
    </script>
    <script src="assets/gdp_sample_by_region.js">
    </script>
    <script src="assets/jquery.ui.widget.js">
    </script>
    <script src="assets/jquery.ui.core.js">
    </script>
    <script src="assets/jquery.ui.mouse.js">
    </script>
    <script src="assets/jquery.ui.slider.js">
    </script>
</head>

<body>
    <a href="../grid/index.html">click here for rankings</a>
    <br>
    <div id="wrapper">
        <div id="menu">
            <h2 id="africa_en_west">
                Western
            </h2>
            <h2 id="africa_en_south">
                Southern
            </h2>
            <h2 id="africa_en_east">
                Eastern
            </h2>
            <h2 id="africa_en_north">
                Northern
            </h2>
        </div>
        <div id="map1"></div>
        <!-- <div id="key"></div> -->
        <div id="make-key-button"></div>
        <div id="slider" style="width: 96%; margin: 10px"></div>
        <div id="yearLabel" style="width: 96%; margin: 10px">
            <span class="left-float-text"></span>
            <span class="right-float-text"></span>
        </div>
    </div>

    <div class="clear-fix"></div>
    <script>
    //global var
    var current_map_id;
    var min_scroller = 2000;
    var max_scroller = 2013;
    var map;


    jQuery.noConflict();
    jQuery(function() {
        var $ = jQuery;
        generateMap('africa_en_west');
        // $('#map1').vectorMap({
        //     map: 'africa_en_west',
        //     series: {
        //         regions: [{
        //             scale: ['#FFFFFF', '#0071A4'],
        //             normalizeFunction: 'polynomial',
        //             values: gdp_sample['africa_en_west']
        //         }]
        //     }
        // });

        // current_map_id = 'africa_en_west';
    })

    function generateMap(map_id, dataset){
      //recreate another map
      if (typeof dataset == "undefined") dataset = gdp_sample;
      jQuery('.jvectormap-container').remove();
      jQuery('#map1').vectorMap({
          map: map_id,
          focusOn: {
              x: 0,
              y: 1,
              scale: 1
          },
          series: {
              regions: [{
                  scale: ['#C8EEFF', '#0071A4'],
                  normalizeFunction: 'polynomial',
                  values: dataset[map_id]
              }]
          },
          onRegionLabelShow: function(e, l, c){
            l.html("<img src='../country_flag_png/"+c+".png' alt='"+c+"' width='18' height='12'> " + l.html() + " GDP = " + dataset[current_map_id][c]);
          }
      });

      //update global var
      current_map_id = map_id;
      map = $('#map1').vectorMap('get', 'mapObject');
    }

    var $ = jQuery;
    jQuery(document).ready(function() {
        jQuery('h2').each(function() {
            // change map
            jQuery(this).click(function() {
                jQuery('.tab-selected').removeClass('tab-selected');
                jQuery(this).addClass('tab-selected');
                generateMap(this.id);
            });
        });
        jQuery('h2:first').addClass('tab-selected');
    });
    // var mapObject = $('#map1').vectorMap('get', 'mapObject');

    $("#slider").slider({
        value: min_scroller,
        min: min_scroller,
        max: max_scroller,
        step: 1,
        slide: function(event, ui) {
            val = ui.value;
            //TODO: change this hacker way
            generateMap(current_map_id,sample2);
            // map.series.regions[0].setValues(sample2[current_map_id]);
            // map.series.markers[0].setValues(data.metro.unemployment[ui.value]);
            // map.series.markers[1].setValues(data.metro.population[ui.value]);
        }
    });

    // update left and right values

    $(".left-float-text").text(min_scroller);
    $(".right-float-text").text(max_scroller);

    // update map object
    function updateMap(){
      map = $('#map1').vectorMap('get', 'mapObject');
    }

    // Making key
    function makekey(){
      var key = $("#key");
      updateMap();
      key.toggleClass("invisible");
      key.empty();
      var localMin = map.series.regions[0].scale.clearMinValue;
      var localMax = map.series.regions[0].scale.clearMaxValue;
      var steps = 4;
      for (var i = 0; i<=steps; i++) {
        var val = (localMax-localMin)/steps*i;

        var color = map.series.regions[0].scale.getValue(val);
          key.append('<div style="background-color:' + color + ';">' + val.toFixed(2) + ' - ' + i*(100/4).toFixed(2) + '%</div>');
      }    
    }

    // make-key-button
    

    </script>
</body>

</html>
